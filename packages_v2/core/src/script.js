"use strict";(()=>{var x=!1,M=!1,E=[],O=-1;function N(e){W(e)}function W(e){E.includes(e)||E.push(e),k()}function k(){!M&&!x&&(x=!0,queueMicrotask(I))}function I(){x=!1,M=!0;for(let e=0;e<E.length;e++)E[e](),O=e;E.length=0,O=-1,M=!1}var D=["push","pop","shift","unshift","splice","sort","reverse"],g=null,L=new WeakMap;function P(e,t){if(!g)return;let n=L.get(e);n||L.set(e,n=new Map);let o=n.get(t);o||n.set(t,o=new Set),o.add(g),g.deps.add(o)}function m(e,t){let n=L.get(e);if(!n)return;let o=n.get(t);o&&o.forEach(r=>N(r))}function $(e){return typeof e!="object"||e===null||e.__isReactive?e:new Proxy(e,{get(t,n,o){if(n==="__isReactive")return!0;let r=Reflect.get(t,n,o);return console.log(`INTERNAL get key ${String(n)}`),P(t,n),Array.isArray(t)&&D.includes(n)?(...s)=>{let i=t.length,l=r.apply(t,s);return t.length!==i&&m(t,"length"),l}:typeof r=="object"&&r!==null?$(r):r},set(t,n,o,r){let s=Reflect.get(t,n,r),i=Reflect.set(t,n,o,r);return console.log(`INTERNAL set key ${String(n)}`),o!==s&&(m(t,n),Array.isArray(t)&&n!=="length"&&!isNaN(Number(n))&&Number(n)>=t.length-1&&m(t,"length")),i},deleteProperty(t,n){let o=Reflect.deleteProperty(t,n);return m(t,n),o}})}function u(e){let t=()=>{let n=new Set,o=t.deps;t.deps=n;let r=g;g=t;try{e()}finally{g=r}o.forEach(s=>{t.deps.has(s)||s.delete(t)})};return t.deps=new Set,t(),()=>{t.deps.forEach(n=>n.delete(t)),t.deps.clear()}}function T(e){if(C(e))return e;let t={__isRef:!0,_value:e,get value(){return P(t,"value"),this._value},set value(n){n!==this._value&&(this._value=n,m(t,"value"))}};if(Array.isArray(e)){t._value=$([...e]),D.forEach(o=>{let r=t._value[o];typeof r=="function"&&Object.defineProperty(t._value,o,{value:function(...s){let i=r.apply(this,s);return m(t,"value"),i},writable:!0,configurable:!0,enumerable:!1})});let n=t._value;t._value=new Proxy(n,{set(o,r,s,i){let l=Reflect.set(o,r,s,i);return isNaN(Number(r))||m(t,"value"),l}})}else typeof e=="object"&&e!==null&&(t._value=$(e));return t}function C(e){return!!(e&&e.__isRef===!0)}function w(e){return typeof e=="object"&&e!==null}function b(e){return typeof e=="function"}function f(e){return C(e)?e.value:b(e)?e():e}var j={};function d(e,t){j[e]=t}function F(e,t,n,o){if(t in j)return j[t](e,n,o);if(t.startsWith("on")&&b(n))return e.addEventListener(t.slice(2).toLowerCase(),r=>n(r,e)),()=>e.removeEventListener(t.slice(2).toLowerCase(),n);if(!t.startsWith("_")&&!t.startsWith("$"))return u(()=>{let r=f(n);e[t]!==r&&(e[t]=r)})}function B(){d("$text",V),d("$show",U),d("$class",Z),d("$style",z),d("$for",Q),d("$each",()=>{}),d("$key",()=>{})}function V(e,t){u(()=>{let n=f(t);e.textContent!==String(n)&&(e.textContent=String(n))})}function U(e,t){u(()=>{let n,o=0;typeof t=="object"&&t!==null&&"value"in t?(n=f(t.value),o=t.hideDelay||0):n=f(t),e._shouldShow!==n&&(!n&&o>0?(e._shouldShow=!1,setTimeout(()=>{e.style.display="none"},o)):(e._shouldShow=n,e.style.display=n?"block":"none"))})}function Z(e,t){let n=e;if(!n._originalClasses){let o=new Set;n._originalClasses=o.add(n.classList)}return u(()=>{let o=f(t);n._viletClasses&&n._viletClasses.forEach(s=>n.classList.remove(s.toString()));let r=new Set;typeof o=="string"?o.split(/\s+/).forEach(s=>{s&&r.add(S(s))}):typeof o=="object"?Object.entries(o).forEach(([s,i])=>{f(i)&&r.add(S(s))}):Array.isArray(o)&&o.forEach(s=>{typeof s=="string"?r.add(S(s)):typeof s=="object"&&Object.entries(s).forEach(([i,l])=>{f(l)&&r.add(S(i))})}),r.forEach(s=>n.classList.add(s.toString())),n._viletClasses=r})}function S(e){let t=document.createElement("div");return t.className=e,t.classList}function z(e,t){let n=e;return n._originalStyle||(n._originalStyle=n.getAttribute("style")||""),u(()=>{let o=f(t);n._viletStyles&&Object.keys(n._viletStyles).forEach(s=>{n.style.removeProperty(s)}),n._originalStyle?n.setAttribute("style",n._originalStyle):n.removeAttribute("style");let r={};if(typeof o=="string"){let s=o.trim();if(s){let i=n.getAttribute("style")||"",l=i&&!i.endsWith(";")?"; ":"",h=s.endsWith(";")?s:s+";";n.setAttribute("style",i+l+h),G(h,r)}}else typeof o=="object"&&Object.entries(o).forEach(([s,i])=>{let l=f(i);if(l!=null){let h=s.replace(/([A-Z])/g,"-$1").toLowerCase();n.style.setProperty(h,String(l)),r[h]=l}});n._viletStyles=r})}function G(e,t){e.split(";").filter(o=>o.trim()).forEach(o=>{let r=o.indexOf(":");if(r>0){let s=o.substring(0,r).trim(),i=o.substring(r+1).trim();s&&i&&(t[s]=i)}})}function Q(e,t,n){let o={},r=new WeakMap,s=0;return u(()=>{let i=f(t);if(!Array.isArray(i))return;console.log("For effect: "+JSON.stringify(i));let l=i.map((c,p)=>n.$key?n.$key(c,p):typeof c=="object"&&c!==null?(r.has(c)||r.set(c,`obj_${s++}`),r.get(c)):`${c}_${p}`);Object.keys(o).filter(c=>!l.includes(c)).forEach(c=>{o[c].unmount(e),delete o[c]}),l.forEach((c,p)=>{if(!o[c]){let a=n.$each(i[p],p);a.mount(e),o[c]=a}}),l.forEach((c,p)=>{let a=o[c];if(a&&a.elements&&a.elements.length>0){let J=a.elements[0],R=p,H=Array.from(e.children).indexOf(J);H!==R&&H!==-1&&a.elements.forEach(A=>{R>=e.children.length?e.appendChild(A):e.insertBefore(A,e.children[R])})}})})}function y(e){if(!w(e))return;let t=this??document,n=e.$element??e.$el??t.querySelector(e.$selector??e.$select??e.$),o=[];for(let[s,i]of Object.entries(e)){let l=F(n,s,i,e);b(l)&&o.push(l)}return{element:n,cleanup:o,destroy(){this.cleanup.forEach(s=>s())}}}function K(e){let t=document.querySelector(e);if(!t||!(t instanceof HTMLTemplateElement))return null;let n=t.content.cloneNode(!0);return{mounted:!1,elements:[],fragment:n,mount(r){this.mounted=!0,this.elements=Array.from(n.childNodes),r.appendChild(n)},unmount(r){this.mounted=!1,this.elements.forEach(s=>{s.parentNode===r&&r.removeChild(s)}),this.elements=[]}}}B();var q=T(0);y({$selector:"#counter",textContent:q,onClick:()=>q.value++});var v=T([]),_=T("");y({$selector:"#container",$for:v,$key:e=>e.id,$each:e=>{let t=K("#todo-template");if(t)return y.bind(t.fragment)({$selector:"#card",onclick:()=>{v.value=v.value.filter(n=>n.id!==e.id)}}),y.bind(t.fragment)({$selector:"#title",textContent:e.title}),t}});y({$selector:"#title-input",value:_,oninput:e=>{_.value=e.target?.value}});y({$selector:"#add-button",onclick:()=>{console.log("click"),v.value.push({id:crypto.randomUUID(),title:_.value}),_.value=""}});})();
