"use strict";(()=>{var R=!1,S=!1,E=[],L=-1;function $(e){P(e)}function P(e){E.includes(e)||E.push(e),O()}function O(){!S&&!R&&(R=!0,queueMicrotask(q))}function q(){R=!1,S=!0;for(let e=0;e<E.length;e++)E[e](),L=e;E.length=0,L=-1,S=!1}var V=["push","pop","shift","unshift","splice","sort","reverse"],g=null,_=new WeakMap;function H(e,n){if(!g)return;let t=_.get(e);t||_.set(e,t=new Map);let o=t.get(n);o||t.set(n,o=new Set),o.add(g),g.deps.add(o)}function m(e,n){let t=_.get(e);if(!t)return;let o=t.get(n);o&&o.forEach(r=>$(r))}function x(e){return typeof e!="object"||e===null||e.__isReactive?e:new Proxy(e,{get(n,t,o){if(t==="__isReactive")return!0;let r=Reflect.get(n,t,o);return console.log(`INTERNAL get key ${String(t)}`),H(n,t),Array.isArray(n)&&V.includes(t)?(...i)=>{let s=n.length,l=r.apply(n,i);return n.length!==s&&m(n,"length"),l}:typeof r=="object"&&r!==null?x(r):r},set(n,t,o,r){let i=Reflect.get(n,t,r),s=Reflect.set(n,t,o,r);return console.log(`INTERNAL set key ${String(t)}`),o!==i&&(m(n,t),Array.isArray(n)&&t!=="length"&&!isNaN(Number(t))&&Number(t)>=n.length-1&&m(n,"length")),s},deleteProperty(n,t){let o=Reflect.deleteProperty(n,t);return m(n,t),o}})}function u(e){let n=()=>{let t=new Set,o=n.deps;n.deps=t;let r=g;g=n;try{e()}finally{g=r}o.forEach(i=>{n.deps.has(i)||i.delete(n)})};return n.deps=new Set,n(),()=>{n.deps.forEach(t=>t.delete(n)),n.deps.clear()}}function b(e){if(C(e))return e;let n={__isRef:!0,_value:e,get value(){return H(n,"value"),this._value},set value(t){t!==this._value&&(this._value=t,m(n,"value"))}};if(Array.isArray(e)){n._value=x([...e]),V.forEach(o=>{let r=n._value[o];typeof r=="function"&&Object.defineProperty(n._value,o,{value:function(...i){let s=r.apply(this,i);return m(n,"value"),s},writable:!0,configurable:!0,enumerable:!1})});let t=n._value;n._value=new Proxy(t,{set(o,r,i,s){let l=Reflect.set(o,r,i,s);return isNaN(Number(r))||m(n,"value"),l}})}else typeof e=="object"&&e!==null&&(n._value=x(e));return n}function C(e){return!!(e&&e.__isRef===!0)}function T(e){return typeof e=="object"&&e!==null}function v(e){return typeof e=="function"}function f(e){return C(e)?e.value:v(e)?e():e}var A=new Map;function d(e,n){A.set(e,n)}function j(e,n,t,o){let r=A.get(n);if(r)return r(e,t,o);if(n.startsWith("on")&&v(t)){let i=n.slice(2).toLowerCase(),s=l=>t(l,e);return e.addEventListener(i,s),()=>e.removeEventListener(i,s)}if(!n.startsWith("_")&&!n.startsWith("$"))return u(()=>{let i=f(t);e[n]!==i&&(e[n]=i)})}function F(){d("$text",B),d("$show",D),d("$class",I),d("$style",J),d("$for",Z),d("$each",()=>{}),d("$key",()=>{})}function B(e,n){u(()=>{let t=f(n),o=String(t);e.textContent!==o&&(e.textContent=o)})}function D(e,n){u(()=>{let t,o=0;W(n)?(t=f(n.value),o=n.hideDelay||0):t=f(n);let r=e;r._shouldShow!==t&&(!t&&o>0?(r._shouldShow=!1,setTimeout(()=>{e.style.display="none"},o)):(r._shouldShow=t,e.style.display=t?"block":"none"))})}function W(e){return typeof e=="object"&&e!==null&&"value"in e}function I(e,n){let t=e;return t._originalClasses||(t._originalClasses=new Set(Array.from(t.classList))),u(()=>{let o=f(n);t._viletClasses&&t._viletClasses.forEach(i=>t.classList.remove(i));let r=new Set;typeof o=="string"?o.split(/\s+/).forEach(i=>{i.trim()&&r.add(i.trim())}):Array.isArray(o)?o.forEach(i=>{typeof i=="string"?r.add(i):T(i)&&Object.entries(i).forEach(([s,l])=>{f(l)&&r.add(s)})}):T(o)&&Object.entries(o).forEach(([i,s])=>{f(s)&&r.add(i)}),r.forEach(i=>t.classList.add(i)),t._viletClasses=r})}function J(e,n){let t=e;return t._originalStyle===void 0&&(t._originalStyle=t.getAttribute("style")||""),u(()=>{let o=f(n);t._viletStyles&&Object.keys(t._viletStyles).forEach(i=>{t.style.removeProperty(i)}),t._originalStyle?t.setAttribute("style",t._originalStyle):t.removeAttribute("style");let r={};if(typeof o=="string"){let i=o.trim();if(i){let s=t.getAttribute("style")||"",l=s&&!s.endsWith(";")?"; ":"",h=i.endsWith(";")?i:i+";";t.setAttribute("style",s+l+h),U(h,r)}}else T(o)&&Object.entries(o).forEach(([i,s])=>{let l=f(s);if(l!=null){let h=k(i);t.style.setProperty(h,String(l)),r[h]=String(l)}});t._viletStyles=r})}function k(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function U(e,n){e.split(";").filter(o=>o.trim()).forEach(o=>{let r=o.indexOf(":");if(r>0){let i=o.substring(0,r).trim(),s=o.substring(r+1).trim();i&&s&&(n[i]=s)}})}function Z(e,n,t){let o=new Map,r=new WeakMap,i=0;return u(()=>{let s=f(n);if(!Array.isArray(s))return;let l=s.map((c,a)=>t.$key?t.$key(c,a):typeof c=="object"&&c!==null?(r.has(c)||r.set(c,`obj_${i++}`),r.get(c)):`${c}_${a}`);Array.from(o.keys()).filter(c=>!l.includes(c)).forEach(c=>{let a=o.get(c);a&&(a.unmount(e),o.delete(c))}),l.forEach((c,a)=>{if(!o.has(c)){if(t.$each===void 0)throw new Error("required $each binding is missing for $for binding");let y=t.$each(s[a],a);y.mount(e),o.set(c,y)}}),l.forEach((c,a)=>{let y=o.get(c);if(y?.elements?.length){let K=y.elements[0],w=Array.from(e.children).indexOf(K);w!==a&&w!==-1&&y.elements.forEach(M=>{a>=e.children.length?e.appendChild(M):e.insertBefore(M,e.children[a])})}})})}function p(e){if(!T(e))return;let n=this??document,t=e.$element??e.$el??n.querySelector(e.$selector??e.$select??e.$??"");if(!t)throw new Error("Element not found");let o=[];for(let[r,i]of Object.entries(e)){let s=j(t,r,i,e);v(s)&&o.push(s)}return{element:t,cleanup:o,destroy(){this.cleanup.forEach(r=>r())}}}function N(e){let n=document.querySelector(e);if(!n||!(n instanceof HTMLTemplateElement))return null;let t=n.content.cloneNode(!0);return{mounted:!1,elements:[],fragment:t,mount(r){this.elements=Array.from(t.childNodes),this.mounted=!0,r.appendChild(t)},unmount(r){this.mounted=!1,this.elements.forEach(i=>{i.parentNode===r&&r.removeChild(i)}),this.elements=[]}}}F();function z(){let e=b(0);p({$selector:"#counter",textContent:String(e),onClick:()=>e.value++})}function G(){let e=b([]),n=b("");p({$selector:"#container",$for:e,$key:t=>t.id,$each:t=>{let o=N("#todo-template");if(!o)throw new Error("#todo-template not found");return p.bind(o.fragment)({$selector:"#card",onclick:()=>{e.value=e.value.filter(r=>r.id!==t.id)}}),p.bind(o.fragment)({$selector:"#title",textContent:t.title}),o}}),p({$selector:"#title-input",value:n,oninput:t=>{n.value=t.target?.value}}),p({$selector:"#add-button",onclick:()=>{console.log("click"),e.value.push({id:crypto.randomUUID(),title:n.value}),n.value=""}})}z();G();})();
