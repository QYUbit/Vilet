"use strict";(()=>{var _=!1,x=!1,v=[],A=-1;function C(e){q(e)}function q(e){v.includes(e)||v.push(e),B()}function B(){!x&&!_&&(_=!0,queueMicrotask(D))}function D(){_=!1,x=!0;for(let e=0;e<v.length;e++)v[e](),A=e;v.length=0,A=-1,x=!1}var j=["push","pop","shift","unshift","splice","sort","reverse"],h=null,w=new WeakMap;function N(e,n){if(!h)return;let t=w.get(e);t||w.set(e,t=new Map);let o=t.get(n);o||t.set(n,o=new Set),o.add(h),h.deps.add(o)}function p(e,n){let t=w.get(e);if(!t)return;let o=t.get(n);o&&o.forEach(r=>C(r))}function b(e){return typeof e!="object"||e===null||e.__isReactive?e:new Proxy(e,{get(n,t,o){if(t==="__isReactive")return!0;let r=Reflect.get(n,t,o);return console.log(`INTERNAL get key ${String(t)}`),N(n,t),Array.isArray(n)&&j.includes(t)?(...i)=>{let s=n.length,l=r.apply(n,i);return n.length!==s&&p(n,"length"),l}:typeof r=="object"&&r!==null?b(r):r},set(n,t,o,r){let i=Reflect.get(n,t,r),s=Reflect.set(n,t,o,r);return console.log(`INTERNAL set key ${String(t)}`),o!==i&&(p(n,t),Array.isArray(n)&&t!=="length"&&!isNaN(Number(t))&&Number(t)>=n.length-1&&p(n,"length")),s},deleteProperty(n,t){let o=Reflect.deleteProperty(n,t);return p(n,t),o}})}function u(e){let n=()=>{let t=new Set,o=n.deps;n.deps=t;let r=h;h=n;try{e()}finally{h=r}o.forEach(i=>{n.deps.has(i)||i.delete(n)})};return n.deps=new Set,n(),()=>{n.deps.forEach(t=>t.delete(n)),n.deps.clear()}}function E(e){if(M(e))return e;let n={__isRef:!0,_value:e,get value(){return N(n,"value"),this._value},set value(t){t!==this._value&&(this._value=t,p(n,"value"))}};if(Array.isArray(e)){n._value=b([...e]),j.forEach(o=>{let r=n._value[o];typeof r=="function"&&Object.defineProperty(n._value,o,{value:function(...i){let s=r.apply(this,i);return p(n,"value"),s},writable:!0,configurable:!0,enumerable:!1})});let t=n._value;n._value=new Proxy(t,{set(o,r,i,s){let l=Reflect.set(o,r,i,s);return isNaN(Number(r))||p(n,"value"),l}})}else typeof e=="object"&&e!==null&&(n._value=b(e));return n}function M(e){return!!(e&&e.__isRef===!0)}function T(e){return typeof e=="object"&&e!==null}function S(e){return typeof e=="function"}function f(e){return M(e)?e.value:S(e)?e():e}var F=new Map;function d(e,n){F.set(e,n)}function $(e,n,t,o){let r=F.get(n);if(r)return r(e,t,o);if(n.startsWith("on")&&S(t)){let i=n.slice(2).toLowerCase(),s=l=>t(l,e);return e.addEventListener(i,s),()=>e.removeEventListener(i,s)}if(!n.startsWith("_")&&!n.startsWith("$"))return u(()=>{let i=f(t);e[n]!==i&&(e[n]=i)})}function O(){d("$text",J),d("$show",I),d("$class",U),d("$style",Z),d("$for",Q),d("$each",()=>{}),d("$key",()=>{})}function J(e,n){u(()=>{let t=f(n),o=String(t);e.textContent!==o&&(e.textContent=o)})}function I(e,n){u(()=>{let t,o=0;W(n)?(t=f(n.value),o=n.hideDelay||0):t=f(n);let r=e;r._shouldShow!==t&&(!t&&o>0?(r._shouldShow=!1,setTimeout(()=>{e.style.display="none"},o)):(r._shouldShow=t,e.style.display=t?"block":"none"))})}function W(e){return typeof e=="object"&&e!==null&&"value"in e}function U(e,n){let t=e;return t._originalClasses||(t._originalClasses=new Set(Array.from(t.classList))),u(()=>{let o=f(n);t._viletClasses&&t._viletClasses.forEach(i=>t.classList.remove(i));let r=new Set;typeof o=="string"?o.split(/\s+/).forEach(i=>{i.trim()&&r.add(i.trim())}):Array.isArray(o)?o.forEach(i=>{typeof i=="string"?r.add(i):T(i)&&Object.entries(i).forEach(([s,l])=>{f(l)&&r.add(s)})}):T(o)&&Object.entries(o).forEach(([i,s])=>{f(s)&&r.add(i)}),r.forEach(i=>t.classList.add(i)),t._viletClasses=r})}function Z(e,n){let t=e;return t._originalStyle===void 0&&(t._originalStyle=t.getAttribute("style")||""),u(()=>{let o=f(n);t._viletStyles&&Object.keys(t._viletStyles).forEach(i=>{t.style.removeProperty(i)}),t._originalStyle?t.setAttribute("style",t._originalStyle):t.removeAttribute("style");let r={};if(typeof o=="string"){let i=o.trim();if(i){let s=t.getAttribute("style")||"",l=s&&!s.endsWith(";")?"; ":"",g=i.endsWith(";")?i:i+";";t.setAttribute("style",s+l+g),G(g,r)}}else T(o)&&Object.entries(o).forEach(([i,s])=>{let l=f(s);if(l!=null){let g=z(i);t.style.setProperty(g,String(l)),r[g]=String(l)}});t._viletStyles=r})}function z(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function G(e,n){e.split(";").filter(o=>o.trim()).forEach(o=>{let r=o.indexOf(":");if(r>0){let i=o.substring(0,r).trim(),s=o.substring(r+1).trim();i&&s&&(n[i]=s)}})}function Q(e,n,t){let o=new Map,r=new WeakMap,i=0;return u(()=>{let s=f(n);if(!Array.isArray(s))return;let l=s.map((a,c)=>t.$key?t.$key(a,c):typeof a=="object"&&a!==null?(r.has(a)||r.set(a,`obj_${i++}`),r.get(a)):`${a}_${c}`);Array.from(o.keys()).filter(a=>!l.includes(a)).forEach(a=>{let c=o.get(a);c&&(c.unmount(e),o.delete(a))}),l.forEach((a,c)=>{if(!o.has(a)){if(t.$each===void 0)throw new Error("required $each binding is missing for $for binding");let y=t.$each(s[c],c);y.mount(e),o.set(a,y)}}),l.forEach((a,c)=>{let y=o.get(a);if(y?.elements?.length){let k=y.elements[0],V=Array.from(e.children).indexOf(k);V!==c&&V!==-1&&y.elements.forEach(H=>{c>=e.children.length?e.appendChild(H):e.insertBefore(H,e.children[c])})}})})}function m(e){if(!T(e))return;let n=this??document,t=e.$element??e.$el??n.querySelector(e.$selector??e.$select??e.$??"");if(!t)throw new Error("Element not found");let o=[];for(let[r,i]of Object.entries(e)){let s=$(t,r,i,e);S(s)&&o.push(s)}return{element:t,cleanup:o,destroy(){this.cleanup.forEach(r=>r())}}}function L(e){let n=document.querySelector(e);if(!n||!(n instanceof HTMLTemplateElement))return null;let t=n.content.cloneNode(!0);return{mounted:!1,elements:[],fragment:t,mount(r){this.elements=Array.from(t.childNodes),this.mounted=!0,r.appendChild(t)},unmount(r){this.mounted=!1,this.elements.forEach(i=>{i.parentNode===r&&r.removeChild(i)}),this.elements=[]}}}O();var K=0;function P(){let e=K;return K++,`vilet_${e}`}function R(e,n){let t=n?.storage||"localStorage";if(!(t in window)){console.warn(`Cannot use store plugin, since ${t} is not available`);return}let o=window[t],r=o.getItem(n?.key??P());r&&(n?.onload?n.onload(JSON.parse(r)):e.value=JSON.parse(r)),u(()=>{o.setItem(n?.key??P(),JSON.stringify(e.value))})}function X(){let e=E(0);R(e,{key:"counter_count"}),m({$selector:"#counter-button",onClick:()=>e.value++}),m({$selector:"#counter-display",textContent:e})}function Y(){let e=E([]),n=E("");R(e,{key:"todolist_todos"}),R(n,{key:"todo_title_input",storage:"sessionStorage"}),m({$selector:"#container",$for:e,$key:t=>t.id,$each:t=>{let o=L("#todo-template");if(!o)throw new Error("#todo-template not found");return m({$element:o.fragment.querySelector("#card"),onclick:()=>{e.value=e.value.filter(r=>r.id!==t.id)}}),m({$element:o.fragment.querySelector("#title"),textContent:t.title}),o}}),m({$selector:"#title-input",value:n,oninput:t=>{n.value=t.target?.value}}),m({$selector:"#add-button",onclick:()=>{console.log("click"),e.value.push({id:crypto.randomUUID(),title:n.value}),n.value=""}})}X();Y();})();
